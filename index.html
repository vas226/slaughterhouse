<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>Хорор Гра в стилі Baldy</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: 'Courier New', Courier, monospace;
    text-align: center;
    margin: 0; padding: 0;
  }
  #game {
    margin: 20px auto;
    width: 320px;
    height: 320px;
    background: #222;
    border: 3px solid red;
    position: relative;
    overflow: hidden;
  }
  .cell {
    width: 80px;
    height: 80px;
    box-sizing: border-box;
    border: 1px solid #444;
    float: left;
    position: relative;
  }
  #log {
    margin-top: 15px;
    height: 100px;
    overflow-y: auto;
    background: #111;
    border: 1px solid #444;
    padding: 5px;
    font-size: 14px;
  }
  .player {
    background: url('https://i.imgur.com/4jEhxx7.png') no-repeat center center;
    background-size: 60px 60px;
  }
  .monster {
    background: url('https://i.imgur.com/hQHWL6d.png') no-repeat center center;
    background-size: 70px 70px;
    animation: flicker 1s infinite;
  }
  .key {
    background: url('https://i.imgur.com/OYUwDKv.png') no-repeat center center;
    background-size: 40px 40px;
  }
  .exit {
    background: url('https://i.imgur.com/4XjZJTP.png') no-repeat center center;
    background-size: 70px 70px;
  }

  @keyframes flicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  #controls button {
    margin: 5px;
    padding: 10px 15px;
    font-size: 18px;
    background: #440000;
    color: #eee;
    border: none;
    cursor: pointer;
    border-radius: 5px;
  }
  #controls button:hover {
    background: #880000;
  }
</style>
</head>
<body>

<h1>Хорор Гра в стилі Baldy</h1>

<div id="game"></div>

<div id="controls">
  <button onclick="move('up')">⬆ Вгору</button><br />
  <button onclick="move('left')">⬅ Вліво</button>
  <button onclick="move('down')">⬇ Вниз</button>
  <button onclick="move('right')">➡ Вправо</button><br />
  <button onclick="pickup()">Підібрати предмет</button>
</div>

<div id="log"></div>

<script>
  const gameEl = document.getElementById('game');
  const logEl = document.getElementById('log');

  // Розмір сітки 4x4
  const gridSize = 4;

  // Кожна клітинка - об'єкт із властивостями
  const cells = [];

  // Позиція гравця
  let playerPos = { x: 0, y: 0 };
  // Позиція монстра
  let monsterPos = { x: 3, y: 3 };
  // Ключ розташування
  let keyPos = { x: 1, y: 2 };
  // Вихід
  let exitPos = { x: 3, y: 0 };

  // Інвентар гравця
  let inventory = [];

  // Ініціалізація сітки
  function initGrid() {
    gameEl.innerHTML = '';
    for(let y=0; y<gridSize; y++) {
      for(let x=0; x<gridSize; x++) {
        const cell = document.createElement('div');
        cell.classList.add('cell');
        cell.dataset.x = x;
        cell.dataset.y = y;
        gameEl.appendChild(cell);
        cells.push(cell);
      }
    }
  }

  // Функція для пошуку клітинки за координатами
  function getCell(x, y) {
    return cells.find(c => +c.dataset.x === x && +c.dataset.y === y);
  }

  // Оновлення відображення гри
  function render() {
    // Очистити всі клітинки
    cells.forEach(cell => {
      cell.className = 'cell';
    });

    // Відобразити ключ, якщо він не зібраний
    if (!inventory.includes('ключ')) {
      getCell(keyPos.x, keyPos.y).classList.add('key');
    }

    // Відобразити вихід
    getCell(exitPos.x, exitPos.y).classList.add('exit');

    // Відобразити монстра
    getCell(monsterPos.x, monsterPos.y).classList.add('monster');

    // Відобразити гравця
    getCell(playerPos.x, playerPos.y).classList.add('player');
  }

  // Логування повідомлень
  function log(msg) {
    logEl.innerHTML += msg + '<br>';
    logEl.scrollTop = logEl.scrollHeight;
  }

  // Перевірка зіткнення з монстром
  function checkMonster() {
    if(playerPos.x === monsterPos.x && playerPos.y === monsterPos.y) {
      log('<b style="color:red">Монстр впіймав тебе! ГРА ЗАКІНЧЕНА.</b>');
      alert('Ти загинув від монстра! Спробуй ще раз.');
      resetGame();
      return true;
    }
    return false;
  }

  // Перевірка, чи гравець дійшов до виходу
  function checkExit() {
    if(playerPos.x === exitPos.x && playerPos.y === exitPos.y) {
      if(inventory.includes('ключ')) {
        log('<b style="color:lime">Ти відкрив двері і вибрався! ВІТАЮ!</b>');
        alert('Ти ВИЖИВ! Гра закінчена.');
        resetGame();
      } else {
        log('Двері зачинені. Потрібен ключ.');
      }
    }
  }

  // Рух гравця
  function move(dir) {
    let newX = playerPos.x;
    let newY = playerPos.y;
    if(dir === 'up') newY--;
    else if(dir === 'down') newY++;
    else if(dir === 'left') newX--;
    else if(dir === 'right') newX++;

    // Перевірка меж сітки
    if(newX < 0 || newX >= gridSize || newY < 0 || newY >= gridSize) {
      log('Ти не можеш туди піти.');
      return;
    }

    playerPos = { x: newX, y: newY };
    log(`Ти пішов ${dir}.`);
    if(checkMonster()) return;
    checkExit();
    render();
  }

  // Підібрати предмет
  function pickup() {
    if(playerPos.x === keyPos.x && playerPos.y === keyPos.y && !inventory.includes('ключ')) {
      inventory.push('ключ');
      log('Ти підібрав ключ!');
      render();
    } else {
      log('Нема чого брати тут.');
    }
  }

  // Рух монстра (рандомний кожні 2 секунди)
  function monsterMove() {
    const directions = [
      {x:0, y:-1}, {x:0, y:1}, {x:-1, y:0}, {x:1, y:0}
    ];
    let possibleMoves = directions.filter(d => {
      let nx = monsterPos.x + d.x;
      let ny = monsterPos.y + d.y;
      return nx >= 0 && nx < gridSize && ny >= 0 && ny < gridSize;
    });
    let move = possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
    monsterPos.x += move.x;
    monsterPos.y += move.y;

    if(checkMonster()) return;

    render();
  }

  // Скидання гри
  function resetGame() {
    playerPos = { x: 0, y: 0 };
    monsterPos = { x: 3, y: 3 };
    inventory = [];
    logEl.innerHTML = '';
    log('Гра почалась. Уникай монстра, знайди ключ і вийди!');
    render();
  }

  // Запуск гри
  initGrid();
  resetGame();
  setInterval(monsterMove, 2000);
</script>

</body>
</html>
